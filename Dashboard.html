<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TRY SHOPPY - Pro Dashboard v6</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #0d6efd; --bg: #f4f7fe; --white: #ffffff;
            --text: #1e293b; --border: #cbd5e1; --success: #22c55e;
        }

        body { font-family: 'Cairo', sans-serif; background-color: var(--bg); margin: 0; padding: 20px; color: var(--text); }
        .container { max-width: 1650px; margin: 0 auto; } 
        header { text-align: center; margin-bottom: 25px; border-bottom: 2px solid var(--primary); padding-bottom: 10px; }
        
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 15px; margin-bottom: 25px; }
        .stat-card { background: var(--white); padding: 15px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); border-right: 5px solid var(--primary); }
        .stat-card h3 { margin: 0; font-size: 0.85rem; color: #64748b; }
        .stat-card .value { font-size: 1.5rem; font-weight: 800; margin: 5px 0; color: var(--primary); }

        .filters { background: var(--white); padding: 15px; border-radius: 12px; display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 20px; align-items: center; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .filters input, .filters select { padding: 10px; border: 1px solid var(--border); border-radius: 8px; flex: 1; min-width: 140px; font-family: 'Cairo'; }
        
        .btn-search { background: var(--primary); color: white; border: none; padding: 10px 25px; border-radius: 8px; cursor: pointer; font-weight: bold; }
        .btn-group-action { background: #1a1a1a; color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: bold; transition: 0.3s; }
        .btn-group-action.active { background: #dc2626; }
        
        .btn-print-all { background: #5b21b6; color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: bold; transition: 0.3s; }
        .btn-print-all:hover { background: #4c1d95; }

        .table-wrapper { background: var(--white); border-radius: 12px; overflow: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.08); }
        table { width: 100%; border-collapse: collapse; text-align: right; }
        th { background: #f1f5f9; padding: 15px; border-bottom: 2px solid var(--border); color: #475569; font-size: 0.85rem; }
        td { padding: 15px; border-bottom: 1px solid #f1f5f9; font-size: 0.95rem; vertical-align: middle; }

        /* ØªÙ†Ø³ÙŠÙ‚ Ø®Ø§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªØ¹Ø¯ÙŠÙ„ */
        .price-input { width: 90px; padding: 6px; border: 1px solid var(--border); border-radius: 6px; font-family: 'Cairo'; font-weight: bold; text-align: center; }

        .spec-badge { background: #eff6ff; color: #1e40af; padding: 2px 8px; border-radius: 4px; font-size: 0.75rem; font-weight: 600; display: block; margin-top: 3px; }
        .btn-print { background: #000; color: #fff; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-weight: bold; }
        .btn-update { background: var(--success); color: white; border: none; padding: 5px 10px; border-radius: 4px; cursor: pointer; }
        .link-btn { color: var(--primary); text-decoration: none; font-weight: bold; font-size: 0.8rem; border: 1px solid var(--primary); padding: 4px 8px; border-radius: 4px; }
    </style>
</head>
<body style="display:none;">

<script>
const SESSION_TIME = 2 * 60 * 60 * 1000; // Ø³Ø§Ø¹ØªÙŠÙ† Ø¨Ø§Ù„Ù…Ù„ÙŠ Ø«Ø§Ù†ÙŠØ©
const auth = localStorage.getItem("auth");
const loginTime = localStorage.getItem("loginTime");
const now = new Date().getTime();

if(auth === "true" && loginTime && (now - loginTime < SESSION_TIME)){
  // Ø§Ù„Ø¬Ù„Ø³Ø© Ù…Ø§ Ø²Ø§Ù„Øª ØµØ§Ù„Ø­Ø©
  document.body.style.display = "block";
}else{
  // Ø§Ù„Ø¬Ù„Ø³Ø© Ø§Ù†ØªÙ‡Øª Ø£Ùˆ Ø£ÙˆÙ„ Ø¯Ø®ÙˆÙ„
  const password = prompt("Enter Password:");
  if(password === "945992"){
    localStorage.setItem("auth","true");
    localStorage.setItem("loginTime", now);
    document.body.style.display = "block";
  }else{
    document.body.innerHTML="<h2 style='text-align:center;margin-top:50px;'>Access Denied âŒ</h2>";
  }
}
</script>


<div class="container">
    <header style="display:flex; justify-content:space-between; align-items:center;">
  <h1>Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… TRY SHOPPY</h1>
  <button onclick="logout()" 
    style="background:#dc2626;color:white;border:none;padding:8px 15px;border-radius:6px;cursor:pointer;font-weight:bold;">
    ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
  </button>
</header>


    <div class="stats-grid">
        <div class="stat-card"><h3>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª (EGP)</h3><div id="totalEGP" class="value">0</div></div>
        <div class="stat-card" style="border-right-color: var(--success);"><h3>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØªÙƒÙ„ÙØ© (USD)</h3><div id="totalUSD" class="value">0</div></div>
        <div class="stat-card" style="border-right-color: #f59e0b;"><h3>Ø¹Ø¯Ø¯ Ø§Ù„Ø´Ø­Ù†Ø§Øª</h3><div id="totalCount" class="value">0</div></div>
    </div>

    <div class="filters">
        <input type="date" id="dateFrom">
        <input type="date" id="dateTo">
        <input id="searchInput" placeholder="ğŸ” Ø§Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù…ØŒ Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ØŒ Ø£Ùˆ Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨...">
        <select id="searchStatus">
            <option value="">ÙƒÙ„ Ø§Ù„Ø­Ø§Ù„Ø§Øª</option>
            <option value="Pending Review">Pending Review</option>
            <option value="Shipped To You">Shipped To You</option>
            <option value="Delivered">Delivered</option>
			<option value="Confirmed Via Try">Confirmed Via Try</option>
			<option value="Placed">Placed</option>
			<option value="Canceled">Canceled</option>
			<option value="Processing">Processing</option>
			<option value="Arrived USA HUB">Arrived USA HUB</option>
			<option value="Arrived Cairo HUB">Arrived Cairo HUB</option>
        </select>
        <button class="btn-search" onclick="applyFilters()">Ø¨Ø­Ø«</button>
        <button id="groupBtn" class="btn-group-action" onclick="toggleGrouping()">ğŸ”„ ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</button>
        <button class="btn-print-all" onclick="printAllDisplayed()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© ÙƒØ§ÙØ© Ø¨ÙˆØ§Ù„Øµ Ø§Ù„Ø¬Ø¯ÙˆÙ„</button>
    </div>

    <div class="table-wrapper">
        <table>
            <thead>
                <tr>
                    <th>Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨</th>
                    <th>Ø§Ù„Ø¹Ù…ÙŠÙ„</th>
                    <th>Ø§Ù„Ù…ÙˆØ§ØµÙØ§Øª (Ø¹Ø¯Ø¯/ÙˆØ²Ù†)</th>
                    <th>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ (EGP)</th>
                    <th>Ø§Ù„ØªÙƒÙ„ÙØ© (USD)</th>
                    <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                    <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡</th>
                    <th>Ø§Ù„Ø¨ÙˆÙ„ÙŠØµØ©</th>
                    <th>Ø§Ù„Ù…Ù†ØªØ¬</th>
                </tr>
            </thead>
            <tbody id="tableBody"></tbody>
        </table>
    </div>
</div>

<script>
const scriptURL = "https://script.google.com/macros/s/AKfycbyzDnWhqG4elYJcIsgPPUlVJoA4VjG2aysQoFs0n00kOUaxwkt1GCPBkAGW19_GOwox-A/exec";
let ordersData = [];
let currentFilteredData = [];
let isGrouped = false;

async function loadData() {
    try {
        const res = await fetch(scriptURL);
        ordersData = await res.json();
        applyFilters(); 
    } catch(e) { console.error("Data Load Error", e); }
}

function renderTable(data) {
    const tbody = document.getElementById("tableBody");
    tbody.innerHTML = "";
    data.forEach(o => {
        const cur = o.status || "Pending Review";
        const printPhone = o.phone ? o.phone.toString().replace(/\s/g, '') : '';
        const printOrder = o.order ? o.order.toString().split(' + ')[0] : 'N/A';
		const dimensionsValue = isGrouped ? "Ù…ØªØ¹Ø¯Ø¯Ø©" : (o.dimensions || "ØºÙŠØ± Ù…Ø­Ø¯Ø¯");

        tbody.innerHTML += `<tr>
            <td style="font-weight:bold;">${o.order}</td>
            <td><b>${o.customerName}</b><br><small>${o.phone}</small></td>
            <td>
                <span class="spec-badge">Ø§Ù„ÙƒÙ…ÙŠØ©: ${isGrouped ? o.totalQty : (o.quantity || 1)}</span>
                <span class="spec-badge">Ø§Ù„ÙˆØ²Ù†: ${parseFloat(o.totalWeight || o.weight || 0).toFixed(2)} Ø¬Ù…</span>
				<span class="spec-badge">Ø§Ù„ÙˆØµÙ: ${dimensionsValue}</span>
            </td>
            <td>
                <input type="number" id="egp-${printOrder}" class="price-input" value="${o.finalPrice || 0}">
            </td>
            <td>
                <input type="number" id="usd-${printOrder}" class="price-input" value="${parseFloat(o.usd || 0).toFixed(2)}">
            </td>
            <td>
                <select id="status-${printOrder}" style="padding:4px; font-size:0.8rem;">
                    <option value="Pending Review" ${cur==='Pending Review'?'selected':''}>Pending Review</option>
					<option value="Confirmed Via Try" ${cur==='Confirmed Via Try'?'selected':''}>Confirmed Via Try</option>
					<option value="Placed" ${cur==='Placed'?'selected':''}>Placed</option>
                    <option value="Processing" ${cur==='Processing'?'selected':''}>Processing</option>
                    <option value="Shipped To You" ${cur==='Shipped To You'?'selected':''}>Shipped To You</option>
                    <option value="Delivered" ${cur==='Delivered'?'selected':''}>Delivered</option>
					<option value="Canceled" ${cur==='Canceled'?'selected':''}>Canceled</option>
					<option value="Arrived USA HUB" ${cur==='Arrived USA HUB'?'selected':''}>Arrived USA HUB</option>
					<option value="Arrived Cairo HUB" ${cur==='Arrived Cairo HUB'?'selected':''}>Arrived Cairo HUB</option>
                </select>
            </td>
            <td>
                <button class="btn-update" onclick="updateOrder('${printOrder}')">âœ”</button>
            </td>
            <td><button class="btn-print" onclick="printLabel('${printPhone}', '${printOrder}')">ğŸ“„ Ø¨ÙˆÙ„ÙŠØµØ©</button></td>
            <td>${o.link ? `<a href="${o.link}" target="_blank" class="link-btn">Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø©</a>` : '-'}</td>
        </tr>`;
    });
}

function applyFilters() {
    const from = document.getElementById("dateFrom").value;
    const to = document.getElementById("dateTo").value;
    const search = document.getElementById("searchInput").value.toLowerCase();
    const status = document.getElementById("searchStatus").value;

    let filtered = ordersData.filter(o => {
        const d = o.date ? new Date(o.date).toISOString().split('T')[0] : "";
        const dateMatch = (!from || d >= from) && (!to || d <= to);
        const searchMatch = (o.customerName||"").toLowerCase().includes(search) || 
                            (o.phone||"").toString().includes(search) || 
                            (o.order||"").toString().toLowerCase().includes(search);
        const statusMatch = !status || o.status === status;
        return dateMatch && searchMatch && statusMatch;
    });
  // Ø§Ù„Ø£Ø­Ø¯Ø« Ø£ÙˆÙ„Ø§Ù‹ Ø­Ø³Ø¨ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙÙŠ Google Sheet
  filtered = filtered.reverse();
	
    const totalEGP = filtered.reduce((a,b) => a + parseFloat(b.finalPrice || 0), 0);
    const totalUSD = filtered.reduce((a,b) => a + parseFloat(b.usd || 0), 0);
    document.getElementById("totalEGP").innerText = totalEGP.toLocaleString() + " EGP";
    document.getElementById("totalUSD").innerText = totalUSD.toLocaleString() + " $";
    document.getElementById("totalCount").innerText = filtered.length;

    if (isGrouped) {
        const groups = {};
        filtered.forEach(o => {
            const key = o.phone ? o.phone.toString().replace(/\s/g, '') : 'Unknown';
            if (!groups[key]) {
                groups[key] = { ...o, order: [o.order], count: 1, totalQty: parseInt(o.quantity || 1), totalWeight: parseFloat(o.weight || 0), finalPrice: parseFloat(o.finalPrice || 0), usd: parseFloat(o.usd || 0) };
            } else {
                groups[key].order.push(o.order);
                groups[key].count += 1;
                groups[key].totalQty += parseInt(o.quantity || 1);
                groups[key].totalWeight += parseFloat(o.weight || 0);
                groups[key].finalPrice += parseFloat(o.finalPrice || 0);
                groups[key].usd += parseFloat(o.usd || 0);
            }
        });
        filtered = Object.values(groups).map(g => ({ ...g, order: g.order.join(' + ') }));
    }
    
    currentFilteredData = filtered; 
    renderTable(filtered);
}

function toggleGrouping() {
    isGrouped = !isGrouped;
    const btn = document.getElementById("groupBtn");
    btn.innerText = isGrouped ? "ğŸš« ÙÙƒ Ø§Ù„ØªØ¬Ù…ÙŠØ¹" : "ğŸ”„ ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª";
    btn.classList.toggle("active");
    applyFilters(); 
}

function updateOrder(orderId) {
    const newStatus = document.getElementById(`status-${orderId}`).value;
    const newEGP = document.getElementById(`egp-${orderId}`).value;
    const newUSD = document.getElementById(`usd-${orderId}`).value;

    fetch(scriptURL, {
        method: "POST",
        mode: "no-cors",
        body: JSON.stringify({ 
            action: "updateStatus", 
            order: orderId, 
            status: newStatus,
            finalPrice: newEGP,
            usd: newUSD
        })
    }).then(() => {
        alert("ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ø·Ù„Ø¨ #" + orderId);
        loadData();
    });
}


// Ø¯Ø§Ù„Ø© ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø´ÙƒÙ„ (ØªÙ…Øª Ø¥Ø¹Ø§Ø¯ØªÙ‡Ø§ Ù„Ø£ØµÙ„Ù‡Ø§ 100% Ø¨Ø¯ÙˆÙ† ØªØºÙŠÙŠØ± Ø­Ø±Ù ÙˆØ§Ø­Ø¯ ÙÙŠ Ø§Ù„ØªØµÙ…ÙŠÙ…)
function generateLabelHTML(data, isBulk = false) {
    const totalP = data.finalPrice || 0;
    const totalW = parseFloat(data.totalWeight || data.weight || 0).toFixed(2);
    const totalQ = data.totalQty || data.quantity || 1;
    const ids = data.order;

    return `
        <div class="card" style="${isBulk ? 'page-break-after: always;' : ''}">
            <div class="top">
                <div class="logo">TRY SHOPPY</div>
                <div style="font-size: 10pt; text-align: center; border: 1px solid #000; padding: 5px;">AIRWAY BILL<br>OFFICIAL</div>
            </div>
            <div class="info">
                <span>Ø¥Ù„Ù‰ Ø§Ù„Ø³ÙŠØ¯/Ø©:</span>
                <b>${data.customerName}</b>
                ğŸ“ ${data.governorate} - ${data.address}<br>
                ğŸ“ ${data.phone}
            </div>
            <div class="shipping-box">
                <div>Ø§Ù„ÙˆØ²Ù† Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: <b>${totalW} Ø¬Ø±Ø§Ù…</b></div>
                <div>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù‚Ø·Ø¹: <b>${totalQ}</b></div>
            </div>
            <div class="ids-strip">Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø·Ù„Ø¨Ø§Øª: ${ids}</div>
            <div class="cod-area">
                <span>Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ ØªØ­ØµÙŠÙ„Ø© -Ø´Ø§Ù…Ù„ Ø§Ù„Ø´Ø­Ù†  (C.O.D)</span>
                <div class="cod-val">${totalP} EGP</div>
            </div>
            <div class="footer">Ù…Ø³Ù…ÙˆØ­ ÙØªØ­ Ø§Ù„Ø´Ø­Ù†Ø© Ø¹Ù†Ø¯ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù… | ØªØ±Ø§ÙŠ Ø´ÙˆØ¨ÙŠ ØªØªÙ…Ù†ÙŠ Ù„ÙƒÙ… ØªØ¬Ø±Ø¨Ø© Ø³Ø¹ÙŠØ¯Ù‡</div>
        </div>
    `;
}

// Ø¯Ø§Ù„Ø© Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© (ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ ÙÙ‚Ø· Ù„ØªØ¹Ù…Ù„ Ø£ÙˆÙ†Ù„Ø§ÙŠÙ† Ù…Ø¹ Ø§Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø§Ù„ØªÙ†Ø³ÙŠÙ‚)
function printLabel(phone, orderId) {
    const subset = ordersData.filter(x => x.phone && x.phone.toString().replace(/\s/g, '') === phone);
    let toPrint = isGrouped ? currentFilteredData.find(x => x.phone.toString().replace(/\s/g, '') === phone) : subset.find(x => x.order.toString() === orderId.toString());
    
    if(!toPrint) { alert("Ø®Ø·Ø£ ÙÙŠ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨"); return; }

    const win = window.open('', '_blank');
    win.document.write(`
        <html dir="rtl" lang="ar">
        <head>
            <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
            <style>
                @page { size: A5; margin: 0; }
                body { font-family: 'Cairo', sans-serif; margin: 0; padding: 10mm; background: #fff; }
                .card { border: 4px solid #000; height: 185mm; position: relative; padding: 15px; box-sizing: border-box; }
                .top { border-bottom: 4px solid #000; padding-bottom: 15px; display: flex; justify-content: space-between; align-items: center; }
                .logo { font-size: 30pt; font-weight: 900; }
                .info { margin-top: 20px; font-size: 15pt; line-height: 1.6; }
                .info b { font-size: 20pt; display: block; margin-bottom: 10px; }
                .shipping-box { display: flex; justify-content: space-between; margin-top: 20px; border-top: 1px solid #000; padding-top: 15px; font-size: 14pt; }
                .ids-strip { background: #000; color: #fff; padding: 10px; margin-top: 20px; text-align: center; font-size: 9pt; word-break: break-all; }
                .cod-area { border: 5px solid #000; margin-top: 20px; padding: 20px; text-align: center; }
                .cod-area span { font-size: 15pt; display: block; }
                .cod-val { font-size: 40pt; font-weight: 700; }
                .footer { position: absolute; bottom: 15px; width: 92%; text-align: center; font-size: 10pt; font-weight: bold; }
                @media print { .no-print { display: none; } }
            </style>
        </head>
        <body>
            ${generateLabelHTML(toPrint)}
            <div style="text-align: center; margin-top: 20px;" class="no-print">
                <button onclick="window.print()" style="padding: 15px 30px; background: #000; color: #fff; border: none; border-radius: 8px; cursor: pointer; font-family: 'Cairo'; font-weight: bold;">Ø§Ø¶ØºØ· Ù‡Ù†Ø§ Ù„Ù„Ø·Ø¨Ø§Ø¹Ø© Ø£Ùˆ Ø§Ù„Ø­ÙØ¸ PDF</button>
            </div>
        </body>
        </html>
    `);
    win.document.close();
}
function printAllDisplayed() {
    if (currentFilteredData.length === 0) { alert("Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø·Ø¨Ø§Ø¹ØªÙ‡Ø§ Ø­Ø§Ù„ÙŠØ§Ù‹."); return; }
    
    const win = window.open('', '_blank');
    let allLabelsHTML = "";
    
    // ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙˆØ§Ù„Øµ Ø¨Ù†ÙØ³ Ø´ÙƒÙ„Ù‡Ø§ Ø§Ù„Ø£ØµÙ„ÙŠ ØªÙ…Ø§Ù…Ø§Ù‹
    currentFilteredData.forEach(item => { 
        allLabelsHTML += generateLabelHTML(item, true); 
    });

    win.document.write(`
        <html dir="rtl" lang="ar">
        <head>
            <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
            <style>
                @page { size: A5; margin: 0; }
                body { font-family: 'Cairo', sans-serif; margin: 0; padding: 10mm; background: #fff; }
                /* Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ø®Ø§ØµØ© Ø¨Ø´ÙƒÙ„ Ø§Ù„Ø¨ÙˆÙ„ÙŠØµØ© Ø§Ù„Ø£ØµÙ„ÙŠ */
                .card { border: 4px solid #000; height: 185mm; position: relative; padding: 15px; box-sizing: border-box; }
                .top { border-bottom: 4px solid #000; padding-bottom: 15px; display: flex; justify-content: space-between; align-items: center; }
                .logo { font-size: 30pt; font-weight: 900; }
                .info { margin-top: 20px; font-size: 15pt; line-height: 1.6; }
                .info b { font-size: 20pt; display: block; margin-bottom: 10px; }
                .shipping-box { display: flex; justify-content: space-between; margin-top: 20px; border-top: 1px solid #000; padding-top: 15px; font-size: 14pt; }
                .ids-strip { background: #000; color: #fff; padding: 10px; margin-top: 20px; text-align: center; font-size: 9pt; word-break: break-all; }
                .cod-area { border: 5px solid #000; margin-top: 20px; padding: 20px; text-align: center; }
                .cod-area span { font-size: 15pt; display: block; }
                .cod-val { font-size: 40pt; font-weight: 700; }
                .footer { position: absolute; bottom: 15px; width: 92%; text-align: center; font-size: 10pt; font-weight: bold; }
                
                @media print { 
                    .card { page-break-after: always; } 
                    .no-print { display: none; } 
                }
            </style>
        </head>
        <body>
            ${allLabelsHTML}
            <div style="text-align: center; margin-top: 20px;" class="no-print">
                <button onclick="window.print()" style="padding: 15px 30px; background: #2563eb; color: #fff; border: none; border-radius: 8px; font-size: 16px; font-family: 'Cairo'; cursor: pointer; font-weight: bold;">
                    Ø·Ø¨Ø§Ø¹Ø© ÙƒÙ„ Ø§Ù„Ø¨ÙˆØ§Ù„Øµ Ø§Ù„Ù…Ø¬Ù…Ø¹Ø©
                </button>
            </div>
        </body>
        </html>
    `);
    win.document.close();
}
loadData();
</script>
<script>
function logout(){
  localStorage.removeItem("auth");
  localStorage.removeItem("loginTime");
  location.reload();
}
</script>
</body>
</html>
